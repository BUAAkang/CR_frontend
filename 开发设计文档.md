# 宏观功能设计

1. 文档上传功能，继承单元测试模块
2. 需求拆解功能，需要按照MEMS需求规格说明，基于一级标题、二级标题，构造需求树。总节点应当是文档名，一级节点应当是来自于各个一级标题（下内容的总结），二级节点来自于二级标题（下内容的总结），叶子节点应当为二级标题下各个需求的总结
   - 总体需求
    - 范围
    - 引用文档
    - 需求
      - 要求的状态和方式
      - 能力需求
        - 工作流程（叶子节点）
    以上为后端的工作逻辑，前端可能需要引入表达树形结构的组件，具体效果可以参考word中的导航窗格展示文档大纲的过程。
3. 附加说明，首先预处理好438C的各个附录，附录J用于验证“需求规格说明”，其他附录用于验证其他需求文档。需求文档有很多种，建议用户上传文档的时候，就标明文档是什么类型的，直接使用对应的附录来对文档进行验证。目前可以只支持“需求规格说明”的验证。前端需要给出下拉菜单选项供用户选择上传的哪个类型文档。
    附录-文件对应表：
    附录A -《软件开发计划》的正文格式
    附录B -《软件安装计划》的正文格式
    附录C - 《软件移交计划》的正文格式
    附录D - 《软件测试计划》的正文格式
    附录E - 《运行方案说明》的正文格式
    附录F - 《系统/子系统规格说明》的正文格式
    附录G - 《接口需求规格说明》的正文格式
    附录H - 《系统/子系统设计说明》的正文格式
    附录I - 《接口设计说明》的正文格式
    附录J - 《软件需求规格说明》的正文格式
    附录K - 《软件设计说明》的正文格式
    附录L - 《数据库设计说明》的正文格式
    附录M - 《软件测试说明》的正文格式
    附录N - 《软件测试报告》的正文格式
    附录O - 《软件产品规格说明》的正文格式
    附录P - 《软件版本说明》的正文格式
    附录Q - 《软件用户手册》的正文格式
    附录R - 《计算机编程手册》的正文格式
    附录S - 《固件保障手册》的正文格式
    附录T - 《软件研制总结报告》的正文格式
4. 需求验证功能，根据1.提取的需求树的各个节点，都应当与附录J对应，将对应的规则与内容输入给大模型，要求大模型判断是否合规。这是后端的工作逻辑，前端需要在2提出的树型展示组件中标明每个叶子节点的需求是否合规。
5. 需求补全功能，优先级暂缓，具体实现方式是将需求文档正文发给大模型，告诉大模型补充空缺处（1.2），并将1.2的撰写要求（附录J的对应条目）一并发给大模型，对于不能补充的部分，让大模型空着或者标注出来（<EMPTY>）
6. 迭代功能，目标是将补全后文档重新从3开始走一遍，检查文档是否合规
7. 需求导出功能，可导出分条的JSON格式需求

# 前端页面逻辑
**我们的文档审查模块逻辑较为复杂，我认为是非线性的，可能需要基于强哥的简单跳转逻辑进行更改**

可以拆分为文档上传，需求分析，需求补全，需求导出四个页面。

路由跳转逻辑为：
前端文档上传完成后监听后端接口相应，无误后跳转至需求分析模块；
需求分析预想为紧跟上一个接口相应信息，发送文档id，后端返回分析结果（一棵树，每个节点有id,label,content,level,v_status,e_status,children（array）,样式参考Example.json）；**大模型分析有时间问题，后端可能需要异步。前端先不考虑时间设计一版**
需求补全预想为条目级别列举不匹配需求-补全信息对，可以点击一个需求-补全对跳转回树中进行高亮。每个需求-补全对有接受/拒绝两个选项。右下角设置迭代/导出两个按钮，点击任意按钮后都需要对需求树状态进行更新。有未决策条目默认为拒绝补全。拒绝补全的status标记进入白名单，更新后的需求树不对白名单需求进行分析。点击导出按钮跳转到需求导出界面，点击迭代按钮后跳转回需求分析界面。**在当前开发阶段中，可以设置路由守卫为需求分析->需求导出的直接跳转**
需求导出依然是树形界面，用户确认后点击“确认导出”获得json文件

# 需求树的结构
大翔哥，再确认一下设计逻辑。非叶子节点应当不存在需求内容，但是叶子节点可能位于不同的层级/深度，比如说一级标题下即为原子需求，那么该叶结点深度为1，如果三级标题下才到原子需求，那叶结点深度为3。不过星宇画的需求数最深就到二级标题了，相当于需求数最多只有两层深。

# 可能存在的雷点
1. 部署时产生的各种问题（生产环境路由跳转设置/跨域/静态文件访问）
2. json由前端维护（后期可以由我跟踪）
3. 需求树格式对接不完善